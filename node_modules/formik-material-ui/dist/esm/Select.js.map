{"version":3,"file":"Select.js","sources":["../../src/Select.tsx"],"sourcesContent":["import FormControl, { FormControlProps } from '@mui/material/FormControl';\nimport FormHelperText, {\n  FormHelperTextProps,\n} from '@mui/material/FormHelperText';\nimport InputLabel, { InputLabelProps } from '@mui/material/InputLabel';\nimport MuiSelect, { SelectProps as MuiSelectProps } from '@mui/material/Select';\nimport { FieldProps, getIn } from 'formik';\nimport * as React from 'react';\n\nexport interface SelectProps\n  extends FieldProps,\n    Omit<MuiSelectProps, 'name' | 'value'> {\n  formControl?: FormControlProps;\n  formHelperText?: FormHelperTextProps;\n  inputLabel?: InputLabelProps;\n}\n\nexport function fieldToSelect({\n  disabled,\n  field: { onBlur: _onBlur, onChange: fieldOnChange, ...field },\n  form: { isSubmitting, touched, errors, setFieldTouched, setFieldValue },\n  onClose,\n  ...props\n}: Omit<\n  SelectProps,\n  'formControl' | 'formHelperText' | 'inputLabel'\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n>): MuiSelectProps & { formError: any } {\n  const fieldError = getIn(errors, field.name);\n  const showError = getIn(touched, field.name) && !!fieldError;\n\n  return {\n    disabled: disabled ?? isSubmitting,\n    error: showError,\n    formError: showError ? fieldError : undefined,\n    onBlur: () => {\n      // no-op\n    },\n    onChange:\n      fieldOnChange ??\n      (() => {\n        // no-op\n      }),\n    // we must use `onClose` instead of `onChange` to be able to trigger validation when users click outside of the select list.\n    onClose:\n      onClose ??\n      (async (e: React.SyntheticEvent) => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const dataset = (e.target as any).dataset as DOMStringMap;\n        if (dataset && dataset.value) {\n          // out-of-sync issue since November 2019: https://github.com/formium/formik/issues/2059#issuecomment-890613538\n          // without the await, formik validates with the former value\n          await setFieldValue(field.name, dataset.value, false);\n        }\n        setFieldTouched(field.name, true, true);\n      }),\n    ...field,\n    ...props,\n  };\n}\n\nexport function Select({\n  formControl,\n  inputLabel,\n  formHelperText,\n  ...selectProps\n}: SelectProps) {\n  const { error, formError, disabled, ...selectFieldProps } =\n    fieldToSelect(selectProps);\n  const { children: formHelperTextChildren, ...formHelperTextProps } =\n    formHelperText || {};\n  const shouldDisplayFormHelperText = error || formHelperTextChildren;\n\n  return (\n    <FormControl disabled={disabled} error={error} {...formControl}>\n      <InputLabel id={selectFieldProps.labelId} {...inputLabel}>\n        {selectFieldProps.label}\n      </InputLabel>\n      <MuiSelect {...selectFieldProps} />\n      {shouldDisplayFormHelperText && (\n        <FormHelperText {...formHelperTextProps}>\n          {error ? formError : formHelperTextChildren}\n        </FormHelperText>\n      )}\n    </FormControl>\n  );\n}\n\nSelect.displayName = 'FormikMaterialUISelect';\n"],"names":[],"mappings":";;;;;;;;SAiBgB,aAAa,CAAC,EAU7B;IAVD,iBA0CC;QAzCC,QAAQ,cAAA,EACR,aAA6D,WAArC,MAAY,aAAa,cAAA,EAAK,KAAK,cAApD,sBAAsD,CAAF,EAC3D,YAAuE,EAA/D,YAAY,kBAAA,EAAE,OAAO,aAAA,EAAE,MAAM,YAAA,EAAE,eAAe,qBAAA,EAAE,aAAa,mBAAA,EACrE,OAAO,aAAA,EACJ,KAAK,cALoB,wCAM7B;IAKC,IAAM,UAAU,GAAG,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;IAC7C,IAAM,SAAS,GAAG,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC;IAE7D,2BACE,QAAQ,EAAE,QAAQ,aAAR,QAAQ,cAAR,QAAQ,GAAI,YAAY,EAClC,KAAK,EAAE,SAAS,EAChB,SAAS,EAAE,SAAS,GAAG,UAAU,GAAG,SAAS,EAC7C,MAAM,EAAE;SAEP,EACD,QAAQ,EACN,aAAa,aAAb,aAAa,cAAb,aAAa,IACZ;SAEA,CAAC,EAEJ,OAAO,EACL,OAAO,aAAP,OAAO,cAAP,OAAO,IACN,UAAO,CAAuB;;;;;wBAEvB,OAAO,GAAI,CAAC,CAAC,MAAc,CAAC,OAAuB,CAAC;8BACtD,OAAO,IAAI,OAAO,CAAC,KAAK,CAAA,EAAxB,cAAwB;wBAG1B,WAAM,aAAa,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,EAAA;;wBAArD,SAAqD,CAAC;;;wBAExD,eAAe,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;;;;aACzC,CAAC,IACD,KAAK,GACL,KAAK,EACR;AACJ,CAAC;SAEe,MAAM,CAAC,EAKT;IAJZ,IAAA,WAAW,iBAAA,EACX,UAAU,gBAAA,EACV,cAAc,oBAAA,EACX,WAAW,cAJO,+CAKtB,CADe;IAEd,IAAM,KACJ,aAAa,CAAC,WAAW,CAAC,EADpB,KAAK,WAAA,EAAE,SAAS,eAAA,EAAE,QAAQ,cAAA,EAAK,gBAAgB,cAAjD,kCAAmD,CAC7B,CAAC;IAC7B,IAAM,KACJ,cAAc,IAAI,EAAE,EADJ,sBAAsB,cAAA,EAAK,mBAAmB,cAA1D,YAA4D,CAC5C,CAAC;IACvB,IAAM,2BAA2B,GAAG,KAAK,IAAI,sBAAsB,CAAC;IAEpE,QACE,oBAAC,WAAW,aAAC,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,IAAM,WAAW;QAC5D,oBAAC,UAAU,aAAC,EAAE,EAAE,gBAAgB,CAAC,OAAO,IAAM,UAAU,GACrD,gBAAgB,CAAC,KAAK,CACZ;QACb,oBAAC,SAAS,eAAK,gBAAgB,EAAI;QAClC,2BAA2B,KAC1B,oBAAC,cAAc,eAAK,mBAAmB,GACpC,KAAK,GAAG,SAAS,GAAG,sBAAsB,CAC5B,CAClB,CACW,EACd;AACJ,CAAC;AAED,MAAM,CAAC,WAAW,GAAG,wBAAwB;;;;"}